#!/usr/bin/env perl

use warnings;
use strict;
use LWP::Simple qw/get/;
use Getopt::Long;
use Pod::Usage;
use constant NAVER_DICTIONARY_URL => "http://endic.naver.com/search.nhn?isOnlyViewEE=N&query=";
binmode(STDOUT, ":utf8");

our $VERSION = '0.01';

my %options;
GetOptions(\%options, "--help");

run(\%options, @ARGV);

sub run {
    my($opts, @args) = @_;

    if ($opts->{help}) {
        pod2usage(0);
    }

	my @words = @args;
	for my $word (@words) {
		my @kor = post_google($word);
		for my $kor (@kor) {
			$kor =~ s/<[^>]*>//g;
			print $kor, "\n";
		}
	}
}

sub post_google {
    my $word = shift;
	my $html = get(NAVER_DICTIONARY_URL . url_encode($word));
	my @kor = $html =~ m{<span class="fnt_k05">([^<].*?)</span>}sg;
	return @kor;
}

sub url_encode {
	my $url = shift;
	$url =~ s/([^A-Za-z0-9])/sprintf("%%%02X", ord($1))/seg;
	return $url;
}

sub url_decode {
	my $url = shift;
	$url =~ s/\%([A-Fa-f0-9]{2})/pack('C', hex($1))/seg;
	return $url;
}

__END__

=head1 NAME

eng2kor - English to Korean
Dictionary Service, it using google translate

=head1 VERSION

Version 0.01

=head1 SYNOPSIS

	eng2kor some thing "something"

=cut

=head1 AUTHOR

hshong, C<< <hshong at perl.kr> >>

=head1 LICENSE AND COPYRIGHT

Copyright 2010 hshong.

same as Perl.

=cut

1; # End of eng2kor
